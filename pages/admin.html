<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MoBank - Admin</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/@auth0/auth0-spa-js@1.21.0/dist/auth0-spa-js.production.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/headerFooter.js"></script>
</head>
<body>
    <div id="header-placeholder"></div>
    <main id="admin-content">
    </main>
    <div id="footer-placeholder"></div>

    <script>
        async function loadAdminContent() {
            const token = await getToken();
            if (!token) {
                window.location.href = '/pages/login.html';
                return;
            }

            try {
                const response = await fetch('/admin', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const htmlContent = await response.text();
                    document.getElementById('admin-content').innerHTML = htmlContent;

                    document.getElementById('add-student-form').addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const studentName = document.getElementById('student-name').value;
                        alert("Student added successfully! (Implement backend logic)");
                        document.getElementById('add-student-form').reset();
                    });
                } else if (response.status === 403) {
                    alert('Access denied: Admins only.');
                    window.location.href = '/pages/dashboard.html';
                } else if (response.status === 401) {
                    alert('Please log in.');
                    window.location.href = '/pages/login.html';
                } else {
                    throw new Error('An error occurred');
                }
            } catch (error) {
                console.error('Error loading admin content:', error);
            }
        }

        loadAdminContent();
    </script>
</body>
</html>
