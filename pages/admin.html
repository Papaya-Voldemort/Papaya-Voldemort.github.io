<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoBank - Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/@auth0/auth0-spa-js@1.21.0/dist/auth0-spa-js.production.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/headerFooter.js"></script>
</head>
<body>
    <div id="header-placeholder"></div>

    <main id="admin-content" class="hidden">
        <h2>Admin Panel</h2>
        <form id="add-student-form">
            <input type="text" id="student-name" placeholder="Student Name" required>
            <button type="submit">Add Student</button>
        </form>
    </main>

    <div id="footer-placeholder"></div>

    <script>
        async function loadAdminContent() {
            await window.auth0Promise;
            const user = await getUser();
            const roles = user && user['https://mo-bank.vercel.app/roles'] || [];

            if (!roles.includes('admin')) {
                window.location.href = '/pages/dashboard.html';
                return;
            }

            document.getElementById('admin-content').classList.remove('hidden');

            const addStudentForm = document.getElementById('add-student-form');
            addStudentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!roles.includes('admin')) {
                    alert("You do not have permission to perform this action.");
                    return;
                }
                const studentName = document.getElementById('student-name').value;
                alert("Student added successfully! (Implement backend logic)");
                addStudentForm.reset();
            });
        }

        loadAdminContent();
    </script>
</body>
</html>
